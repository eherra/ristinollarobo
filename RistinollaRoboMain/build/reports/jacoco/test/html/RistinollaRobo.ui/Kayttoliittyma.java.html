<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Kayttoliittyma.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">RistinollaRobo</a> &gt; <a href="index.source.html" class="el_package">RistinollaRobo.ui</a> &gt; <span class="el_source">Kayttoliittyma.java</span></div><h1>Kayttoliittyma.java</h1><pre class="source lang-java linenums">
package RistinollaRobo.ui;

import RistinollaRobo.algo.Minimax;
import RistinollaRobo.lauta.Pelisysteemi;
import RistinollaRobo.lauta.Tarkastaja;
import javafx.application.Application;
import javafx.geometry.Insets;
import javafx.geometry.Pos;
import javafx.scene.Scene;
import javafx.scene.control.Button;
import javafx.scene.control.Label;
import javafx.scene.image.Image;
import javafx.scene.image.ImageView;
import javafx.scene.layout.BorderPane;
import javafx.scene.layout.GridPane;
import javafx.scene.layout.HBox;
import javafx.scene.layout.VBox;
import javafx.scene.text.Font;
import javafx.stage.Stage;

/**
 * RistinollaRobon käyttöliittymä JavaFX:llä.
 * Laudan koot 3x3, 10x10 ja 15x15 - valittavissa kaynnistysruudusta. 
 * Koot 3x3 sekä 10x10 toimii sutjakkaasti, mutta 15x15 lauta alkaa olemaan hieman hidas, noin 2-10s per siirto AI:lla.
 */

<span class="nc" id="L28">public class Kayttoliittyma extends Application {    </span>
    private Boolean keskiL, isoL;
    private Stage ikkuna;
    private Button uusiPeli;
    
    @Override
    public void start(Stage ikkuna) throws Exception {
<span class="nc" id="L35">        this.ikkuna = ikkuna;</span>
<span class="nc" id="L36">        this.ikkuna.setScene(getKaynnistysNaytto());</span>
<span class="nc" id="L37">        this.ikkuna.show();</span>
<span class="nc" id="L38">    }</span>
    
    public Scene getKaynnistysNaytto() {
<span class="nc" id="L41">        keskiL = false;</span>
<span class="nc" id="L42">        isoL = false;</span>
<span class="nc" id="L43">        Button pieniLauta = new Button(&quot;3x3&quot;);</span>
<span class="nc" id="L44">        Button keskiLauta = new Button(&quot;10x10&quot;);</span>
<span class="nc" id="L45">        Button isoLauta = new Button(&quot;15x15&quot;);</span>
<span class="nc" id="L46">        Button kaynnistaPeli = new Button(&quot;Käynnistä peli!&quot;);</span>
<span class="nc" id="L47">        Button suljeNappi = new Button(&quot;X&quot;);</span>
        
<span class="nc" id="L49">        pieniLauta.setFont(Font.font(&quot;Monospaced&quot;, 20));</span>
<span class="nc" id="L50">        keskiLauta.setFont(Font.font(&quot;Monospaced&quot;, 20));</span>
<span class="nc" id="L51">        isoLauta.setFont(Font.font(&quot;Monospaced&quot;, 20));</span>
<span class="nc" id="L52">        kaynnistaPeli.setFont(Font.font(&quot;Monospaced&quot;, 20));</span>
<span class="nc" id="L53">        suljeNappi.setFont(Font.font(&quot;Monospaced&quot;, 15));</span>

<span class="nc" id="L55">        pieniLauta.setStyle(&quot;-fx-background-color: #5F9F9F&quot;);</span>
<span class="nc" id="L56">        keskiLauta.setStyle(&quot;-fx-background-color: #B4CDCD&quot;);</span>
<span class="nc" id="L57">        isoLauta.setStyle(&quot;-fx-background-color: #B4CDCD&quot;);</span>
<span class="nc" id="L58">        kaynnistaPeli.setStyle(&quot;-fx-background-color: #B4CDCD&quot;);</span>
<span class="nc" id="L59">        suljeNappi.setStyle(&quot;-fx-background-color: #CD5C5C&quot;);</span>
<span class="nc" id="L60">        kaynnistaPeli.setOnMouseEntered(e -&gt; kaynnistaPeli.setStyle(&quot;-fx-background-color: #20B2AA&quot;));</span>
<span class="nc" id="L61">        kaynnistaPeli.setOnMouseExited(e -&gt; kaynnistaPeli.setStyle(&quot;-fx-background-color: #B4CDCD&quot;));</span>
        
<span class="nc" id="L63">        Label ylateksti = new Label(&quot;RistinollaRobo&quot;);</span>
<span class="nc" id="L64">        ylateksti.setFont(Font.font(&quot;Monospaced&quot;, 40));</span>
        
<span class="nc" id="L66">        HBox kokoNapit = new HBox();</span>
<span class="nc" id="L67">        kokoNapit.setSpacing(20);</span>
<span class="nc" id="L68">        kokoNapit.setAlignment(Pos.CENTER);</span>
<span class="nc" id="L69">        kokoNapit.getChildren().addAll(pieniLauta, keskiLauta, isoLauta);</span>
        
<span class="nc" id="L71">        VBox keskiAsetus = new VBox();</span>
<span class="nc" id="L72">        keskiAsetus.setSpacing(30);</span>
<span class="nc" id="L73">        keskiAsetus.getChildren().addAll(ylateksti, kokoNapit, kaynnistaPeli);</span>
<span class="nc" id="L74">        keskiAsetus.setAlignment(Pos.CENTER);</span>
        
<span class="nc" id="L76">        BorderPane kaynnistysNaytto = new BorderPane();</span>
<span class="nc" id="L77">        kaynnistysNaytto.setPrefSize(500, 400);</span>
<span class="nc" id="L78">        kaynnistysNaytto.setCenter(keskiAsetus);</span>
<span class="nc" id="L79">        kaynnistysNaytto.setRight(suljeNappi);</span>
        
<span class="nc" id="L81">        pieniLauta.setOnMouseClicked(event -&gt; {</span>
<span class="nc" id="L82">            keskiL = false;</span>
<span class="nc" id="L83">            isoL = false;</span>
<span class="nc" id="L84">            pieniLauta.setStyle(&quot;-fx-background-color: #5F9F9F&quot;);</span>
<span class="nc" id="L85">            keskiLauta.setStyle(&quot;-fx-background-color: #B4CDCD&quot;);</span>
<span class="nc" id="L86">            isoLauta.setStyle(&quot;-fx-background-color: #B4CDCD&quot;);</span>
<span class="nc" id="L87">        });</span>
        
<span class="nc" id="L89">        keskiLauta.setOnMouseClicked(event -&gt; {</span>
<span class="nc" id="L90">            keskiL = true;</span>
<span class="nc" id="L91">            isoL = false;</span>
<span class="nc" id="L92">            pieniLauta.setStyle(&quot;-fx-background-color: #B4CDCD&quot;);</span>
<span class="nc" id="L93">            keskiLauta.setStyle(&quot;-fx-background-color: #5F9F9F&quot;);</span>
<span class="nc" id="L94">            isoLauta.setStyle(&quot;-fx-background-color: #B4CDCD&quot;);</span>
<span class="nc" id="L95">        });</span>
        
<span class="nc" id="L97">        isoLauta.setOnMouseClicked(event -&gt; {</span>
<span class="nc" id="L98">            keskiL = false;</span>
<span class="nc" id="L99">            isoL = true;</span>
<span class="nc" id="L100">            pieniLauta.setStyle(&quot;-fx-background-color: #B4CDCD&quot;);</span>
<span class="nc" id="L101">            keskiLauta.setStyle(&quot;-fx-background-color: #B4CDCD&quot;);</span>
<span class="nc" id="L102">            isoLauta.setStyle(&quot;-fx-background-color: #5F9F9F&quot;);</span>
<span class="nc" id="L103">        });</span>
        
<span class="nc" id="L105">        suljeNappi.setOnMouseClicked(event -&gt; {</span>
<span class="nc" id="L106">            ikkuna.close();</span>
<span class="nc" id="L107">        });</span>
        
<span class="nc" id="L109">        kaynnistaPeli.setOnMouseClicked(event -&gt; {</span>
<span class="nc" id="L110">            this.ikkuna.setScene(getPeliScene());</span>
<span class="nc" id="L111">        });</span>
        
<span class="nc" id="L113">        return new Scene(kaynnistysNaytto);</span>
    }
    
    public Scene getPeliScene() {
<span class="nc" id="L117">        Pelisysteemi systeemi = new Pelisysteemi(getLaudanKoko()); </span>
<span class="nc" id="L118">        Tarkastaja tark = new Tarkastaja(systeemi);</span>
<span class="nc" id="L119">        systeemi.setTarkastaja(tark);</span>
<span class="nc" id="L120">        Minimax minMax = new Minimax(tark, systeemi);</span>
<span class="nc" id="L121">        systeemi.setMinimax(minMax);</span>
        
<span class="nc" id="L123">        BorderPane asettelu = new BorderPane();</span>
      
<span class="nc" id="L125">        Label labeli = new Label(&quot;Vuoro: &quot; + systeemi.getVuoro());</span>
<span class="nc" id="L126">        labeli.setFont(Font.font(&quot;Monospaced&quot;, 20));</span>
        
<span class="nc" id="L128">        Button takaisin = new Button(&quot;Takaisin&quot;);</span>
<span class="nc" id="L129">        uusiPeli = new Button(&quot;Uusi peli?&quot;);</span>
<span class="nc" id="L130">        takaisin.setStyle(&quot;-fx-background-color: #CD5C5C&quot;);</span>
<span class="nc" id="L131">        uusiPeli.setStyle(&quot;-fx-background-color: #5F9F9F&quot;);</span>
<span class="nc" id="L132">        uusiPeli.setVisible(false);</span>
        
<span class="nc" id="L134">        BorderPane ylaosa = new BorderPane();</span>
<span class="nc" id="L135">        VBox oikeaYlakulma = new VBox();</span>
<span class="nc" id="L136">        oikeaYlakulma.getChildren().addAll(takaisin, uusiPeli);</span>
<span class="nc" id="L137">        oikeaYlakulma.setSpacing(5);</span>
<span class="nc" id="L138">        ylaosa.setRight(oikeaYlakulma);</span>
<span class="nc" id="L139">        ylaosa.setLeft(labeli);</span>

<span class="nc" id="L141">        GridPane pane = lisaaNapit(systeemi, labeli, tark, minMax);</span>
<span class="nc" id="L142">        asettelu.setTop(ylaosa);        </span>
<span class="nc" id="L143">        asettelu.setPrefSize(300, 180);    </span>
<span class="nc" id="L144">        asettelu.setPadding(new Insets(10, 10, 10, 10));</span>
<span class="nc" id="L145">        asettelu.setCenter(pane);</span>
        
<span class="nc" id="L147">        takaisin.setOnMouseClicked(event -&gt; {</span>
<span class="nc" id="L148">            this.ikkuna.setScene(getKaynnistysNaytto());</span>
<span class="nc" id="L149">        });       </span>
        
<span class="nc" id="L151">        uusiPeli.setOnMouseClicked(event -&gt; {</span>
<span class="nc" id="L152">            this.ikkuna.setScene(getPeliScene());</span>
<span class="nc" id="L153">            uusiPeli.setVisible(false);</span>
<span class="nc" id="L154">        });   </span>
        
<span class="nc" id="L156">        Scene pal = new Scene(asettelu);</span>
<span class="nc" id="L157">        return pal;</span>
    }
    
    public GridPane lisaaNapit(Pelisysteemi systeemi, Label label, Tarkastaja tark, Minimax minimax) {        
<span class="nc" id="L161">        GridPane palautus = new GridPane();</span>
        
<span class="nc bnc" id="L163" title="All 2 branches missed.">        for (int i = 0; i &lt; systeemi.getTaulukonPituus(); i++) {</span>
<span class="nc bnc" id="L164" title="All 2 branches missed.">            for (int j = 0; j &lt; systeemi.getTaulukonPituus(); j++) {</span>
<span class="nc" id="L165">                Button nappula = new Button(&quot; &quot;);</span>
<span class="nc" id="L166">                nappula.setFont(Font.font(&quot;Monospaced&quot;, 20));</span>
                
                //nappulan painallukset
<span class="nc" id="L169">                nappula.setOnAction((event) -&gt; {</span>
<span class="nc bnc" id="L170" title="All 4 branches missed.">                    if (!nappula.getText().equals(&quot; &quot;) || label.getText().startsWith(&quot;L&quot;)) return;</span>
                    
<span class="nc" id="L172">                    nappula.setText(systeemi.getVuoro());</span>
<span class="nc" id="L173">                    Integer viimesinX = GridPane.getRowIndex(nappula);</span>
<span class="nc" id="L174">                    Integer viimesinY = GridPane.getColumnIndex(nappula);</span>
<span class="nc" id="L175">                    systeemi.setArvoTaulukkoon(viimesinX, viimesinY, systeemi.getVuoroArvona());</span>
<span class="nc" id="L176">                    systeemi.vuoroEteenpäin();</span>

<span class="nc bnc" id="L178" title="All 2 branches missed.">                    if (tark.laskePistearvo(viimesinX, viimesinY) == 100) { // tarkistetaan voittiko ihmisen siirto</span>
<span class="nc" id="L179">                        uusiPeli.setVisible(true);</span>
<span class="nc" id="L180">                        label.setText(&quot;Loppu. Ihminen voittaa!&quot;); </span>
<span class="nc" id="L181">                        return;</span>
<span class="nc bnc" id="L182" title="All 2 branches missed.">                    } else if (!systeemi.vuorojaJaljella()) {</span>
<span class="nc" id="L183">                        label.setText(&quot;Loppu. Tasapeli!&quot;); </span>
<span class="nc" id="L184">                        uusiPeli.setVisible(true);</span>
<span class="nc" id="L185">                        return;</span>
                    }
                    
                    //tekoälyn liike
<span class="nc" id="L189">                    int[] liike = minimax.getParasLiike(); </span>
<span class="nc" id="L190">                    systeemi.setArvoTaulukkoon(liike[0], liike[1], 10);</span>
<span class="nc" id="L191">                    Button AI = new Button(&quot;O&quot;);</span>
<span class="nc" id="L192">                    AI.setFont(Font.font(&quot;Monospaced&quot;, 20));</span>
<span class="nc" id="L193">                    palautus.add(AI, liike[1], liike[0]); // laitetaan tekoälyn pelaama siirto käyttöliittymän pelialustalle</span>
<span class="nc" id="L194">                    systeemi.vuoroEteenpäin();</span>
                    
<span class="nc bnc" id="L196" title="All 2 branches missed.">                    if (tark.laskePistearvo(liike[0], liike[1]) == -100) {</span>
<span class="nc" id="L197">                        label.setText(&quot;Loppu. Tekoäly \nvoittaa!&quot;);</span>
<span class="nc" id="L198">                        uusiPeli.setVisible(true);</span>
<span class="nc" id="L199">                        return;</span>
<span class="nc bnc" id="L200" title="All 2 branches missed.">                    } else if (!systeemi.vuorojaJaljella()) {</span>
<span class="nc" id="L201">                        label.setText(&quot;Loppu. Tasapeli!&quot;); </span>
<span class="nc" id="L202">                        uusiPeli.setVisible(true);</span>
<span class="nc" id="L203">                        return;</span>
                    }
                    
<span class="nc" id="L206">                    label.setText(&quot;Vuoro: &quot; + systeemi.getVuoro());</span>
<span class="nc" id="L207">                });</span>
                // nappula GridPaneen
<span class="nc" id="L209">                palautus.add(nappula, j, i);</span>
            }
        }
<span class="nc" id="L212">        return modifoiGridi(palautus);</span>
    }
    
    public GridPane modifoiGridi(GridPane palautus) {
<span class="nc" id="L216">        palautus.setPrefSize(300, 180);</span>
<span class="nc" id="L217">        palautus.setAlignment(Pos.CENTER);</span>
<span class="nc" id="L218">        palautus.setVgap(5);</span>
<span class="nc" id="L219">        palautus.setHgap(5);</span>
<span class="nc" id="L220">        palautus.setPadding(new Insets(10, 10, 10, 10));</span>
<span class="nc" id="L221">        return palautus;</span>
    }
    
    public int getLaudanKoko() {
<span class="nc bnc" id="L225" title="All 2 branches missed.">        if (keskiL) return 10;</span>
<span class="nc bnc" id="L226" title="All 2 branches missed.">        if (isoL) return 15;</span>
<span class="nc" id="L227">        return 3;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.4.201905082037</span></div></body></html>